import os
import re

# Mapping of mojibake to correct characters
REPLACEMENTS = {
    'ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡Ãƒâ€šÃ‚Â¹': 'â‚¹',
    'Ã¢â€šÂ¹': 'â‚¹',
    'ÃƒÆ’Ã‚Â¢Ãƒâ€¦Ã¢â‚¬Å“ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¦': 'âœ…',
    'Ã¢Å“â€¦': 'âœ…',
    'ÃƒÆ’Ã†â€™Ãƒâ€šÃ‚Â¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€šÃ‚Â¦': '...',
    'ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€šÃ‚Â¦': '...',
    'Ã¢â‚¬â€': 'â€”',
    'ÃƒÂ¢Ã¢â€šÂ¬Ã¢â‚¬Å“': 'â€“',
    'Ãƒâ€šÃ‚': ' ',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€šÃ‚Â§ÃƒÂ¢Ã¢â€šÂ¬Ã‹Å“ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€šÃ‚ ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€Â¢Ãƒâ€šÃ‚Â¼': 'ğŸ§‘â€ğŸ’¼',
    'ÃƒÂ°Ã…Â¸Ã‚Â§Ã‚Â¹': 'ğŸ§¹',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã…Â ': 'ğŸ“Š',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â¦': 'ğŸ“¦',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã¢â‚¬Â¹': 'ğŸ“‹',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â¹': 'ğŸ“¹',
    'ÃƒÂ¢Ã¢â‚¬Â Ã¢â‚¬â„¢': 'â†’',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬â„¢Ã‚Â°': 'ğŸ’°',
    'ÃƒÂ°Ã…Â¸Ã‚Â¤Ã‚Â©': 'ğŸ¤©',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬ËœÃƒâ€šÃ‚Â': 'ğŸ‘',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬ËœÃƒâ€šÃ‚Â': 'ğŸ‘',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬ËœÃ‚Â¥': 'ğŸ‘¥',
    'ÃƒÂ°Ã…Â¸Ã…Â½Ã‚Â¯': 'ğŸ¯',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â': 'ğŸ“',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã¢â‚¬Â ': 'ğŸ“…',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â¢': 'ğŸ“¢',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â±': 'ğŸ“±',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â§': 'ğŸ“§',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬Å“Ã‚Â²': 'ğŸ“²',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬â„¢Ã‚Â¬': 'ğŸ’¬',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬â„¢Ã‚Â¥': 'ğŸ’¥',
    'ÃƒÂ°Ã…Â¸Ã¢â‚¬â„¢Ã‚Â¬': 'ğŸ’¬',
    'ÃƒÂ°Ã…Â¸Ã‚Â§Ã¢â‚¬ËœÃƒÂ¢Ã¢â€šÂ¬Ã‚ ÃƒÂ°Ã…Â¸Ã¢â‚¬â„¢Ã‚Â¼': 'ğŸ§‘â€ğŸ’¼',
    'ÃƒÂ°Ã…Â¸Ã‚Â§Ã‚Â§': 'ğŸ§¾',
    'ÃƒÂ°Ã…Â¸Ã‚Â¤Ã‚Â©': 'ğŸ¤©',
    'ÃƒÂ¢Ã‚Â­Ã‚ ': 'â­',
}

# More patterns found in grep
REPLACEMENTS.update({
    'ÃƒÆ’Ã‚Â¢Ãƒâ€¦Ã¢â‚¬Å“ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¦': 'âœ…',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã‚ Ãƒâ€šÃ‚': 'ğŸ”',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã…â€œÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¹': 'ğŸ“‹',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€šÃ‚Â§Ãƒâ€šÃ‚Â¾': 'ğŸ› ï¸',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€šÃ‚Â§ÃƒÂ¢Ã¢â€šÂ¬Ã‹Å“ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€šÃ‚ ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã¢â€Â¢Ãƒâ€šÃ‚Â¼': 'ğŸ§‘â€ğŸ’¼',
    'ÃƒÆ’Ã‚Â¢Ãƒâ€¦Ã¢â‚¬Å“ÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¦': 'âœ…',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã‚ Ãƒâ€šÃ‚': 'ğŸ”',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸ÃƒÂ¢Ã¢â€šÂ¬Ã…â€œÃƒÂ¢Ã¢â€šÂ¬Ã‚Â¹': 'ğŸ“‹',
    'ÃƒÆ’Ã‚Â°Ãƒâ€¦Ã‚Â¸Ãƒâ€šÃ‚Â§Ãƒâ€šÃ‚Â¾': 'ğŸ› ï¸',
})

# Compile regex for performance
# Sort keys by length descending to match longest sequences first
patterns = re.compile('|'.join(re.escape(key) for key in sorted(REPLACEMENTS.keys(), key=len, reverse=True)))

def replace_func(match):
    return REPLACEMENTS[match.group(0)]

def cleanup_file(filepath):
    try:
        with open(filepath, 'r', encoding='utf-8', errors='ignore') as f:
            content = f.read()
        
        new_content = patterns.sub(replace_func, content)
        
        if content != new_content:
            with open(filepath, 'w', encoding='utf-8') as f:
                f.write(new_content)
            print(f"Fixed: {filepath}")
            return True
    except Exception as e:
        print(f"Error processing {filepath}: {e}")
    return False

def main():
    root_dir = r'c:\Users\Administrator\Downloads\Final_KavyaPharmaa\src\main\resources\static'
    for root, dirs, files in os.walk(root_dir):
        for file in files:
            if file.endswith(('.html', '.js', '.css')):
                cleanup_file(os.path.join(root, file))

if __name__ == "__main__":
    main()
